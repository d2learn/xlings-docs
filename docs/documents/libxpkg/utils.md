# ğŸ§­ æ¨¡å—ï¼š`utils`

ä¸€ä¸ªé›†åˆå¸¸ç”¨å·¥å…·æ–¹æ³•çš„æ¨¡å—ï¼Œæä¾›è·¯å¾„è§„èŒƒåŒ–ä¸å­˜åœ¨æ€§æ£€æŸ¥ã€å—æ§ä¸‹è½½å¹¶æ ¡éªŒã€ä»¥åŠå‘½ä»¤è¡Œå‚æ•°è§£æçš„ä¾¿æ·å°è£…ï¼Œé€‚ç”¨äº xlings/xim ç”Ÿæ€è„šæœ¬ã€‚

```lua
import("xim.libxpkg.utils")
```

## ğŸ“‘ å‡½æ•°æ¦‚è§ˆ

| å‡½æ•°å | æè¿° |
|--------|------|
| `utils.filepath_to_absolute(filepath)` | å°†æ–‡ä»¶è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ï¼Œå¹¶æ£€æŸ¥ç›®æ ‡æ˜¯å¦å­˜åœ¨ï¼ˆæ™®é€šæ–‡ä»¶ï¼‰ |
| `utils.try_download_and_check(url, dir, sha256)` | ä¸‹è½½æŒ‡å®š URL è‡³ç›®å½•å¹¶è¿›è¡Œ SHA256 æ ¡éªŒ |
| `utils.input_args_process(cmds_kv, args)` | è§£æå¹¶è§„èŒƒåŒ–å‘½ä»¤è¡Œå‚æ•°ï¼ˆé”®å€¼æ˜ å°„ï¼‰ |

## ğŸ§© æ¥å£è¯¦æƒ…

### `utils.filepath_to_absolute(filepath)`

å°†ä¼ å…¥è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ï¼›è‹¥ä¸ºç›¸å¯¹è·¯å¾„ï¼Œåˆ™ä»¥ `system.rundir()` ä¸ºåŸºå‡†è¿›è¡Œæ‹¼æ¥ã€‚å‡½æ•°åŒæ—¶è¿”å›è¯¥è·¯å¾„æ˜¯å¦å­˜åœ¨ä¸”ä¸ºæ™®é€šæ–‡ä»¶ã€‚

- å‚æ•°ï¼š
    - `filepath` (string)ï¼šåŸå§‹æ–‡ä»¶è·¯å¾„ï¼Œå¯ä¸ºç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„

- è¿”å›ï¼š
    - `(exists, abs_path)`ï¼š
    - `exists` (boolean)ï¼šæ˜¯å¦å­˜åœ¨ä¸”ä¸ºæ™®é€šæ–‡ä»¶
    - `abs_path` (string)ï¼šå½’ä¸€åŒ–åçš„ç»å¯¹è·¯å¾„

- è¡Œä¸ºè¯´æ˜ï¼š
    - ä¸æŠ›å‡ºå¼‚å¸¸ï¼›å³ä¾¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿè¿”å› `false, <ç»å¯¹è·¯å¾„>`ï¼Œä¾¿äºè°ƒç”¨æ–¹å†³å®šåç»­å¤„ç†ã€‚

- ç¤ºä¾‹ï¼š
```lua
local ok, abs = utils.filepath_to_absolute("data/config.json")
```

---

### `utils.try_download_and_check(url, dir, sha256)`

ä¸‹è½½æŒ‡å®šèµ„æºåˆ°ç›®æ ‡ç›®å½•å¹¶è¿›è¡Œ SHA256 æ ¡éªŒã€‚

- å‚æ•°ï¼š
    - `url` (string)ï¼šä¸‹è½½åœ°å€
    - `dir` (string)ï¼šä¿å­˜ç›®å½•
    - `sha256` (string)ï¼šæœŸæœ›çš„ SHA256 æ ¡éªŒå’Œï¼ˆå¯é€‰ï¼‰

- è¿”å›ï¼š
    - `status` (boolean): çŠ¶æ€
    - `filename` (string): æ–‡ä»¶è·¯å¾„

- å…¸å‹ç”¨æ³•ï¼š
```lua
local ok, fname = utils.try_download_and_check(
    "https://example.com/pkg.tar.gz",
    "yourDir",
    -- sha256 å¯çœç•¥
    "f5d1278e8109edd..."
)
```

---

### `utils.input_args_process(cmds_kv, args)`

å¯¹å‘½ä»¤è¡Œè¾“å…¥è¿›è¡Œè§£æä¸è§„èŒƒåŒ–ï¼Œå°†å‚æ•°æ˜ å°„åˆ°é¢„å®šä¹‰çš„é”®å€¼ç»“æ„ã€‚

- å‚æ•°ï¼š
    - `cmds_kv` (table)ï¼šå‘½ä»¤å®šä¹‰çš„é”®å€¼æ˜ å°„è¡¨ï¼Œç”¨äºæè¿°å¯æ¥å—çš„å‚æ•°åŠå…¶åˆ«åã€ç±»å‹ã€é»˜è®¤å€¼ç­‰
    - `args` (table)ï¼šåŸå§‹å‚æ•°æ•°ç»„æˆ–å‘½ä»¤è¡Œå­—ç¬¦ä¸²

- è¿”å›ï¼š
    - `cmds` (table)ï¼šè§£æåçš„å‚æ•°è¡¨ï¼Œå€¼ä¸ºå¯¹åº”çš„è§£æç»“æœ

- ç¤ºä¾‹ï¼š
```lua
local __xscript_input = {
    ["--force"] = false,
    ["--output"] = false,
}

local _, cmds = utils.input_args_process(
    __xscript_input,
    { "--force", "--output", "myOutputPath" }
)
```